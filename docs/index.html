<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digit Recognition Neural Network</title>
    <link rel="icon" type="image/x-icon" href="images/mnist.ico">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="hero">
        <div class="hero-content">
            <div>
                <p class="eyebrow">MNIST Playground</p>
                <h1>Real-Time Digit Recognition</h1>
                <p class="lead">
                    A neural network trained from scratch in Java to classify digits 0-9. Draw on the canvass,
                    follow the preprocessing pipeline, and see how the model responds instantly in your browser.
                </p>
            </div>
            <div class="hero-highlights">
                <div class="usage-card">
                    <span class="stat">Usage at a glance</span>
                    <p>
                        Sketch a digit directly in the 400×400 canvas (mouse or touch), then press
                        “Run inference” to route it through the same preprocessing steps used during training.
                        Watch the prediction, confidence and top-5 classes update instantly; hit “Clear” whenever
                        you want to iterate and test new strokes.
                    </p>
                </div>
            </div>
        </div>
    </header>

    <main class="page">
        <section class="workspace">
            <div class="canvas-panel">
                <div class="panel-header">
                    <div>
                        <h2>Interactive Canvas</h2>
                        <p>Draw with mouse or touch. The canvas is centered and scaled to 28×28 before inference.</p>
                    </div>
                    <div class="tool-buttons">
                        <button id="penBtn" class="tool-btn active">Pen</button>
                        <button id="eraserBtn" class="tool-btn">Eraser</button>
                    </div>
                </div>
                <div class="canvas-wrapper">
                    <canvas id="drawingCanvas" width="400" height="400"></canvas>
                    <div class="canvas-overlay">
                        <p>Draw here</p>
                    </div>
                </div>
                <div class="actions">
                    <button id="clearBtn" class="action secondary">Clear</button>
                    <button id="predictBtn" class="action primary">Run inference</button>
                </div>
            </div>

            <div class="insights-panel">
                <div class="panel-section">
                    <div class="panel-header compact">
                        <div>
                            <h3>Prediction</h3>
                            <p>Confidence derived from the Softmax output.</p>
                        </div>
                    </div>
                    <div id="result" class="result-card hidden">
                        <div class="prediction">
                            <span class="prediction-value" id="predictionValue">-</span>
                            <p class="prediction-label" id="predictionLabel">Waiting for input...</p>
                        </div>
                        <div class="confidence-block">
                            <div class="confidence-info">
                                <span>Confidence</span>
                                <strong id="confidencePercentage">0%</strong>
                            </div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" id="confidenceFill"></div>
                            </div>
                        </div>
                        <div class="probabilities">
                            <div class="probabilities-header">
                                <h4>Top 5 classes</h4>
                            </div>
                            <ul id="probabilitiesList" class="probabilities-list"></ul>
                        </div>
                    </div>
                </div>

                <div class="panel-section preview-section">
                    <div class="panel-header compact">
                        <div>
                            <h3>28×28 Preview</h3>
                            <p>Exact representation used during training (centered + normalized).</p>
                        </div>
                    </div>
                    <canvas id="previewCanvas" width="200" height="200"></canvas>
                </div>
            </div>
        </section>

        <section class="info-grid">
            <article class="info-card">
                <h4>Pipeline overview</h4>
                <ol>
                    <li>Sketch a digit on the 400×400 canvas (mouse or touch).</li>
                    <li>The UI trims the bounding box, scales to 28×28, inverts and standardizes the pixels.</li>
                    <li>Weights from training session of this model are loaded into the JS mirror of the network.</li>
                    <li>The dashboard displays prediction, confidence, top-5 classes, and the exact 28×28 preview.</li>
                </ol>
            </article>
            <article class="info-card">
                <h4>Network &amp; training</h4>
                <ul>
                    <li>Dense layers: 784 → 256 → 128 → 10 with ReLU + Softmax.</li>
                    <li>Mini-batch SGD (batch 64), learning rate 0.1.</li>
                    <li>Cross-Entropy loss; early stop threshold 0.0001 or rising loss over 10 epochs.</li>
                    <li>Training converged at epoch 59 with final loss 0.00098.</li>
                    <li>Standardization: <code>(pixel / 255 − 0.1307) / 0.3081</code>.</li>
                    <li>Weights are exported to a csv file (the one that defines the model).</li>
                </ul>
            </article>
            <article class="info-card">
                <h4>What to watch</h4>
                <ul>
                    <li>The 28×28 preview mirrors exactly what the model ingests.</li>
                    <li>Confidence bar = Softmax probability of the predicted digit.</li>
                    <li>Top-5 list reveals how similar digits are ranked (e.g., 3 vs 8).</li>
                    <li>Loss/accuracy metrics were recorded during training and summarized above.</li>
                </ul>
            </article>
        </section>
    </main>

    <footer class="site-footer">
        <p>Educational neural network implemented from scratch in Java + JavaScript. Built by LuisR (GitHub: @LuisAPR1) using MNIST data.</p>
    </footer>

    <script src="neural-network.js"></script>
    <script src="app.js"></script>
</body>
</html>
